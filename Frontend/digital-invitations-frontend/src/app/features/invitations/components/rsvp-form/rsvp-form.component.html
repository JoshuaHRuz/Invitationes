<section class="rsvp-section">
  <div class="container">
    <h2 class="section-title">Confirmar Asistencia</h2>
    <p class="invitation-to" *ngIf="hasGuests">Invitación para: <strong>{{ invitationTo }}</strong></p>
    <p class="passes-info" *ngIf="hasGuests">Boletos disponibles</p>
    <p *ngIf="!hasGuests" class="no-guests-message">
      Por favor, confirma tu asistencia haciendo clic en el botón de abajo.
    </p>

    <form [formGroup]="rsvpForm" (ngSubmit)="onSubmit()">
      <div class="tickets-container" formArrayName="guests" *ngIf="hasGuests">
        <div class="ticket" *ngFor="let guest of guests.controls; let i = index" [formGroupName]="i">
          <div class="ticket-visual">
            <img [src]="invitationData?.story?.mainImageUrl" alt="Foto de la pareja" class="ticket-photo">
            <div class="ticket-date">
              <span class="text-capitalize">{{ eventDate?.dayOfWeek }}</span>
              <span>{{ eventDate?.dayOfMonth }} {{ eventDate?.month }}</span>
              <span>{{ eventDate?.year }}</span>
            </div>
          </div>
          <div class="ticket-info">
            <span class="ticket-number">Boleto #{{ i + 1 }}</span>
            <h3 class="ticket-event-name">{{ invitationData?.eventTitle }}</h3>
            <div class="guest-name-container">
              <label>Invitado:</label>
              <input type="text" formControlName="name" [readOnly]="!guest.value.isEditable" class="guest-name-input">
            </div>
            <div class="attendance-options">
              <label class="radio-label">
                <input type="radio" formControlName="attendance" value="attending">
                <span class="radio-custom"></span>
                <span>Si asistiré</span>
              </label>
              <label class="radio-label">
                <input type="radio" formControlName="attendance" value="not_attending">
                <span class="radio-custom"></span>
                <span>No asistiré</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="message-container" *ngIf="hasGuests">
        <h4>Dedica un lindo mensaje...</h4>
        <textarea formControlName="message" placeholder="Tus palabras significan mucho para nosotros..."></textarea>
      </div>

      <div class="submit-container">
        <button type="submit" class="btn-submit">
          {{ hasGuests ? 'Enviar Confirmación' : 'Confirmar por WhatsApp' }}
        </button>
      </div>
    </form>
  </div>
  <img src="assets/images/elements/flower-divider.png" class="flower-divider" alt="Adorno floral"> 
</section> 